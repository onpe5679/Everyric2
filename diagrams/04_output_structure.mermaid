%%{init: {'theme': 'base'}}%%
flowchart TD
    subgraph OUTPUT["output/YYYYMMDD_HHMMSS/"]
        subgraph CORE["í•µì‹¬ íŒŒì¼"]
            PJ["output.everyric.json<br/>ğŸ“¦ í”„ë¡œì íŠ¸ íŒŒì¼<br/>(ì¬ë¶„í• ìš© ë£¨íŠ¸ ë°ì´í„°)"]
            E["output.srt<br/>ê¸°ë³¸ ì¤„ë‹¨ìœ„ ìë§‰"]
        end
        
        subgraph AUDIO["ì˜¤ë””ì˜¤"]
            A["audio_original.wav<br/>ì›ë³¸ ì˜¤ë””ì˜¤"]
            B["audio_vocals.wav<br/>ë¶„ë¦¬ëœ ë³´ì»¬<br/>(--separate)"]
        end
        
        subgraph LYRICS["ê°€ì‚¬"]
            C["lyrics_original.txt<br/>ì›ë³¸ ê°€ì‚¬"]
            D["lyrics_translated_ko.txt<br/>ë²ˆì—­ëœ ê°€ì‚¬<br/>(--translate)"]
        end
        
        subgraph LINE_MODE["line ëª¨ë“œ ì¶œë ¥<br/>(--translate ì‹œ)"]
            F["output_translated.srt<br/>ë²ˆì—­ë§Œ"]
            F2["output_pronunciation.srt<br/>ì›ë³¸ + ë°œìŒ"]
            F3["output_full.srt<br/>ì›ë³¸ + ë°œìŒ + ë²ˆì—­"]
        end
        
        subgraph DEBUG["ë””ë²„ê·¸ (--debug)"]
            G["diagnostics.png<br/>ì§„ë‹¨ ì´ë¯¸ì§€"]
            H["debug_info.json<br/>ìƒì„¸ ë””ë²„ê·¸ ë°ì´í„°"]
            I["settings.json<br/>ì‹¤í–‰ ì„¤ì •"]
        end
    end

    subgraph REPROCESS["reprocess ì¶œë ¥<br/>(word/character ëª¨ë“œ)"]
        R1["output_word.srt<br/>ğŸ¯ ë‹¨ì–´ë³„ ì •ë°€ íƒ€ì´ë°"]
        R2["output_character.srt<br/>ğŸ¯ ê¸€ìë³„ ì •ë°€ íƒ€ì´ë°"]
        R3["output_translation.srt<br/>ğŸ“ ë²ˆì—­ (ì¤„ë‹¨ìœ„ ìœ ì§€)"]
        R4["output_pronunciation.srt<br/>ğŸ“ ë°œìŒ (ì¤„ë‹¨ìœ„ ìœ ì§€)"]
    end

    subgraph FLAGS["CLI í”Œë˜ê·¸"]
        F1["--debug"]
        F2b["--separate"]
        F3b["--translate"]
        F4["--segment-mode word/char"]
    end

    F1 -.-> DEBUG
    F2b -.-> B
    F3b -.-> D
    F3b -.-> LINE_MODE
    F4 -.-> REPROCESS
    
    PJ -->|"reprocess ëª…ë ¹"| REPROCESS
